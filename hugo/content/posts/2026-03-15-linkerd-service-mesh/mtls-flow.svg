<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 360" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <rect width="800" height="360" fill="#1a1a2e" rx="8"/>
  <text x="400" y="36" text-anchor="middle" fill="#e6b422" font-size="16" font-weight="600">Automatic mTLS: How Linkerd Encrypts Traffic</text>

  <defs>
    <marker id="ma" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4a9e4a"/>
    </marker>
    <marker id="ya2" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e6b422"/>
    </marker>
  </defs>

  <!-- Step labels -->
  <text x="400" y="62" text-anchor="middle" fill="#a0a0b0" font-size="10">Every request between meshed pods follows this flow automatically — zero config required</text>

  <!-- Source Pod -->
  <rect x="40" y="100" width="180" height="120" rx="6" fill="#16213e" stroke="#4a9e4a" stroke-width="1.5"/>
  <text x="130" y="120" text-anchor="middle" fill="#a0a0b0" font-size="9">Source Pod</text>
  <rect x="50" y="130" width="75" height="75" rx="4" fill="#0f3460"/>
  <text x="87" y="165" text-anchor="middle" fill="#c0c0d0" font-size="10">App A</text>
  <text x="87" y="180" text-anchor="middle" fill="#a0a0b0" font-size="8">plaintext</text>
  <text x="87" y="193" text-anchor="middle" fill="#a0a0b0" font-size="8">HTTP</text>
  <rect x="133" y="130" width="75" height="75" rx="4" fill="#1a4a1a" stroke="#4a9e4a" stroke-width="1"/>
  <text x="170" y="155" text-anchor="middle" fill="#4a9e4a" font-size="9" font-weight="600">proxy</text>
  <text x="170" y="170" text-anchor="middle" fill="#4a9e4a" font-size="7">encrypts</text>
  <text x="170" y="183" text-anchor="middle" fill="#4a9e4a" font-size="7">outbound</text>
  <text x="170" y="196" text-anchor="middle" fill="#4a9e4a" font-size="7">traffic</text>

  <!-- Step 1 arrow: app to proxy -->
  <line x1="126" y1="168" x2="131" y2="168" stroke="#c0c0d0" stroke-width="1.5" marker-end="url(#ma)"/>

  <!-- Encrypted tunnel -->
  <rect x="245" y="130" width="310" height="75" rx="20" fill="none" stroke="#4a9e4a" stroke-width="2"/>
  <text x="400" y="155" text-anchor="middle" fill="#4a9e4a" font-size="11" font-weight="600">mTLS Encrypted Channel</text>
  <text x="400" y="173" text-anchor="middle" fill="#4a9e4a" font-size="9">TLS 1.3 + ML-KEM-768 (post-quantum)</text>
  <text x="400" y="190" text-anchor="middle" fill="#a0a0b0" font-size="8">Certificates auto-rotated every 24 hours</text>

  <!-- Arrow from source proxy to tunnel -->
  <line x1="210" y1="168" x2="243" y2="168" stroke="#4a9e4a" stroke-width="2" marker-end="url(#ma)"/>

  <!-- Arrow from tunnel to dest proxy -->
  <line x1="557" y1="168" x2="590" y2="168" stroke="#4a9e4a" stroke-width="2" marker-end="url(#ma)"/>

  <!-- Destination Pod -->
  <rect x="580" y="100" width="180" height="120" rx="6" fill="#16213e" stroke="#4a9e4a" stroke-width="1.5"/>
  <text x="670" y="120" text-anchor="middle" fill="#a0a0b0" font-size="9">Destination Pod</text>
  <rect x="590" y="130" width="75" height="75" rx="4" fill="#1a4a1a" stroke="#4a9e4a" stroke-width="1"/>
  <text x="627" y="155" text-anchor="middle" fill="#4a9e4a" font-size="9" font-weight="600">proxy</text>
  <text x="627" y="170" text-anchor="middle" fill="#4a9e4a" font-size="7">decrypts</text>
  <text x="627" y="183" text-anchor="middle" fill="#4a9e4a" font-size="7">inbound</text>
  <text x="627" y="196" text-anchor="middle" fill="#4a9e4a" font-size="7">traffic</text>
  <rect x="673" y="130" width="75" height="75" rx="4" fill="#0f3460"/>
  <text x="710" y="165" text-anchor="middle" fill="#c0c0d0" font-size="10">App B</text>
  <text x="710" y="180" text-anchor="middle" fill="#a0a0b0" font-size="8">plaintext</text>
  <text x="710" y="193" text-anchor="middle" fill="#a0a0b0" font-size="8">HTTP</text>

  <!-- Step arrow: proxy to app -->
  <line x1="667" y1="168" x2="671" y2="168" stroke="#c0c0d0" stroke-width="1.5" marker-end="url(#ma)"/>

  <!-- Certificate trust chain -->
  <text x="400" y="250" text-anchor="middle" fill="#e6b422" font-size="12" font-weight="600">Certificate Trust Chain</text>

  <!-- Trust Anchor -->
  <rect x="60" y="268" width="180" height="40" rx="6" fill="#0f3460" stroke="#e6b422" stroke-width="1.5"/>
  <text x="150" y="286" text-anchor="middle" fill="#e6b422" font-size="10" font-weight="600">Trust Anchor (Root CA)</text>
  <text x="150" y="300" text-anchor="middle" fill="#a0a0b0" font-size="8">10-year validity, offline key</text>

  <!-- Issuer Cert -->
  <rect x="310" y="268" width="180" height="40" rx="6" fill="#0f3460" stroke="#e6b422" stroke-width="1.5"/>
  <text x="400" y="286" text-anchor="middle" fill="#e6b422" font-size="10" font-weight="600">Issuer (Intermediate CA)</text>
  <text x="400" y="300" text-anchor="middle" fill="#a0a0b0" font-size="8">cert-manager, 1-year rotation</text>

  <!-- Leaf Certs -->
  <rect x="560" y="268" width="180" height="40" rx="6" fill="#0f3460" stroke="#e6b422" stroke-width="1.5"/>
  <text x="650" y="286" text-anchor="middle" fill="#e6b422" font-size="10" font-weight="600">Leaf Certs (Per-Proxy)</text>
  <text x="650" y="300" text-anchor="middle" fill="#a0a0b0" font-size="8">24h validity, auto-rotated</text>

  <!-- Chain arrows -->
  <line x1="242" y1="288" x2="308" y2="288" stroke="#e6b422" stroke-width="1.5" marker-end="url(#ya2)"/>
  <line x1="492" y1="288" x2="558" y2="288" stroke="#e6b422" stroke-width="1.5" marker-end="url(#ya2)"/>
  <text x="275" y="280" fill="#a0a0b0" font-size="7">signs</text>
  <text x="525" y="280" fill="#a0a0b0" font-size="7">signs</text>

  <!-- Caption -->
  <text x="400" y="340" text-anchor="middle" fill="#a0a0b0" font-size="9">Linkerd 2.19 defaults to post-quantum ML-KEM-768 key exchange — future-proofing against quantum computing threats</text>
</svg>
